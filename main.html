<!DOCTYPE html>
<html>
<head>
  <title>Main Page</title>
  <script>
    const urlParams = new URLSearchParams(window.location.search);
    const username = urlParams.get('username');
    let balance = parseFloat(urlParams.get('balance'));

    function updateBalanceDisplay() {
      document.getElementById('balance').innerText = balance;
    }

    function deposit() {
      const amount = parseFloat(document.getElementById('amount').value);
      if (amount > 0) {
        google.script.run.withSuccessHandler(function(response) {
          if (response.success) {
            balance = response.balance;
            updateBalanceDisplay();
          } else {
            alert(response.msg);
          }
        }).updateBalance(username, amount);
      }
    }

    function withdraw() {
      const amount = parseFloat(document.getElementById('amount').value);
      if (amount > 0) {
        google.script.run.withSuccessHandler(function(response) {
          if (response.success) {
            balance = response.balance;
            updateBalanceDisplay();
          } else {
            alert(response.msg);
          }
        }).updateBalance(username, -amount);
      }
    }
  </script>
</head>
<body onload="updateBalanceDisplay()">
  <h2>Welcome, <span id="usernameDisplay"></span></h2>
  <p>Balance: <span id="balance"></span></p>
  <input id="amount" type="number" placeholder="Amount"><br>
  <button onclick="deposit()">Deposit</button>
  <button onclick="withdraw()">Withdraw</button>
</body>
</html>

